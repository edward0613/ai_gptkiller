model.eval()
while True:
  sentence=input().strip()
  if sentence=='stop':break
  data=pd.DataFrame([[sentence,'positive']],columns=['Text','Emotion'])
  dataset = EmotionDataset(data, tokenizer, max_length, label2id)
  loader = DataLoader(dataset, batch_size=1,num_workers=2)
  for batch in loader:
    input_ids = batch['input_ids'].to(device)
    attention_mask = batch['attention_mask'].to(device)
    labels = batch['label'].to(device)
    logits, _ = model(input_ids, attention_mask)
    preds = torch.argmax(logits, dim=1)
    print(id2label[preds.item()])
